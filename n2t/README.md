[Back](../README.md)

# N2T CLI

As discussed in the main [README](../README.md#n2t-command-line-utility) file, this CLI is designed to be a single program that can do all of the following actions:

- Take one or more `.vm` files representing Jack VM language, and generate a single `.asm` Hack assembly file as output.
- Take one or more `.asm` Hack assembly files, and generate a single `.hack` file containing 16 bit binary hack instructions.

## Design

I modeled this tool after the code I had already written for my project [ts-monkey](https://github.com/pwbrown/ts-monkey) which was a TypeScript implementation of the Monkey Language Interpreter from the book [Writing an Interpreter in Go](https://interpreterbook.com/) which I consider to my go to first project whenever I want to test out a new language I'm learning. This interpreter using a more traditional lexical analysis approach and a recursive decent parser that generates an abstract syntax tree that is designed to be evaluating an in REPL (read, evaluate, print, loop) style of program. Most of the code written for ts-monkey did not apply to this project, but the core functionality of the lexer was especially helpful.

Based off the core lexer from `ts-monkey` I also added line and column tracking which make it much easier to debug parsing errors and to annotate code that is generated by the compiler and translator. I also included newline characters and comments as token types since the vm code and hack assembly code are line-delimited language formats. The comment tokens are largely unused, but I left them in anyways.

Additionally I included a `BaseParser` that includes all the boilerplate of accepting a Lexer as input, iterating through tokens, and providing helper functions to analyse current and peek token types. Each primary component of the CLI (compiler, translator, assembler) contain their own unique parsers that extend this BaseParser in order to produce the appropriate output.

## Setup

1. Install [nvm - Node Version Manager](https://github.com/nvm-sh/nvm?tab=readme-ov-file#installing-and-updating)
2. Move to n2t directory: `cd n2t`
3. Install NodeJS: `nvm install`
4. Install build dependencies: `npm install`
5. Build the n2t CLI: `npm run build`

## Usage

### Hack Assembly to Hack Binary

_**Assemble a single .asm file into a .hack file**_
```sh
npm run n2t -- ./MyCode.asm
# generates ./MyCode.hack as output
```

_**Recursively assemble all .asm files within a directory into .hack files**_
```sh
npm run n2t -- ./my-directory/**/*.asm
# generates ./my-directory/**/*.hack for each input .asm file as output
```

### Jack VM to Hack Assembly

_**Assemble a single .vm file into a .asm file**_
```sh
npm run n2t -- ./MyCode.vm
# generates ./MyCode.asm as output
```

_**Recursively assemble all .vm files within a directory into a SINGLE .asm file**_
```sh
npm run n2t -- ./my-directory/**/*.vm
# generates a single ./my-directory/my-directory.asm file as the output
```

### Jack Code to VM Code (Compilation)

_**Perform lexical analysis and parsing on a single Jack file to generate the token and parse tree XML files**_
```sh
npm run n2t -- ./MyCode.jack
# generates:
#   - ./MyCodeT.xml
#   - ./MyCode.xml
```

_**Perform lexical analysis and parsing on a directory of nested Jack files to generate the token and parse tree XML files**_
```sh
npm run n2t -- ./MyCode/**/*.jack
# generates:
#   - ./MyCode/**/*T.xml
#   - ./MyCode/**/*.xml
```